<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<meta name="viewport"
		content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0,viewport-fit=cover">
	<title>FuWeB</title>
	<style>

		button {
			display: none;
			width: 50%;
			height: 10%;
			padding: 16px 0;
			margin: auto 0;
		}
	</style>
</head>

<body>
	<button id="btnShare" onclick="sendShare_Gift()" style="display: none;margin: 20px auto;padding: 20px;">Gift</button>
	<button id="btnLogin" onclick="liff.login()" style="display: none;margin: 20px auto;padding: 20px;">Log In</button>
	<button id="btnLogOut" onclick="logOut()" style="display: none;margin: 20px auto;padding: 20px;">Log Out</button>
	<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
	<script>
		async function sendShare_Gift() {
			name = await liff.getProfile().then((profile) => {
				return profile.displayName;
			}).catch((err) => {
				return err;
			});

			const result = await liff.shareTargetPicker([
				{
					"type": "flex",
					"altText": name + "送禮物來囉!",
					"contents": {
                                    "type": "bubble",
                                    "size": "hecto",
                                    "hero": {
                                                "type": "image",
                                                "url": "https://linefriendssquare.com/cdn/shop/files/Brand_MO_e8a09e2f-53c8-4a50-ac75-e7cc4a3f62da.jpg?v=1719815938",
                                                "size": "full",
                                                "aspectRatio": "20:13",
                                                "aspectMode": "cover",
                                                "action": {
                                                            "type": "uri",
                                                            "uri": "https://line.me/"
                                                            }
                                            },
                                    "body": {
                                                "type": "box",
                                                "layout": "horizontal",
                                                "contents": [
                                                                {
                                                                    "type": "image",
                                                                    "url": "https://lcp-prod-obs.line-scdn.net/0hFnYREqzsGUFkKwiYnkdmFjd2FTBXWh1JDVMEfEBuOAdIGjVyMwYGUR9gORcPGwxfMwY3QQBtOCkiGj9xOBEDQkBiLHI-XgxiDRMGbBdgFwcbXSVLAkUqVw/f640w"
                                                                },
                                                                {
                                                                    "type": "text",
                                                                    "text": "【7-ELEVEN】CITY PEARL冰珍珠焙火烏龍奶茶",
                                                                    "offsetTop": "lg",
                                                                    "offsetBottom": "none",
                                                                    "offsetStart": "none",
                                                                    "offsetEnd": "none",
                                                                    "size": "sm",
                                                                    "wrap": true
                                                                }
                                                            ]
                                            },
                                    "footer": {
                                                "type": "box",
                                                "layout": "vertical",
                                                "spacing": "sm",
                                                "contents": [
                                                                {
                                                                    "type": "button",
                                                                    "style": "secondary",
                                                                    "height": "sm",
                                                                    "action": {
                                                                                "type": "message",
                                                                                "label": "打開我的禮物",
                                                                                "text": "愚人節快樂<3"
                                                                                }
                                                                },
                                                                {
                                                                    "type": "button",
                                                                    "style": "link",
                                                                    "height": "sm",
                                                                    "action": {
                                                                                "type": "message",
                                                                                "label": "傳送感謝小卡",
                                                                                "text": "愚人節快樂<3"
                                                                                }
                                                                },
                                                                {
                                                                    "type": "separator"
                                                                },
                                                                {
                                                                    "type": "box",
                                                                    "layout": "baseline",
                                                                    "contents": [
                                                                                    {
                                                                                        "type": "icon",
                                                                                        "url": "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQVeoZ2LTrOB1F1NOf6ipq2EjdZILvmG9PR5Q&s",
                                                                                        "offsetTop": "xs",
                                                                                        "offsetBottom": "none",
                                                                                        "offsetStart": "none",
                                                                                        "offsetEnd": "none"
                                                                                    },
                                                                                    {
                                                                                        "type": "text",
                                                                                        "text": "LINE 禮物",
                                                                                        "margin": "xs",
                                                                                        "color": "#aeb1b5"
                                                                                    },
                                                                                    {
                                                                                        "type": "icon",
                                                                                        "url": "https://i.imgur.com/aKbXQ9D.png",
                                                                                        "offsetBottom": "none",
                                                                                        "offsetStart": "none",
                                                                                        "offsetEnd": "none",
                                                                                        "offsetTop": "xs"
                                                                                    }
                                                                                ],
                                                                    "margin": "sm"
                                                                }
                                                            ],
                                                    "flex": 0
                                                }
                                }
				}
			])
			if (result) {
				alert(`[${result.status}] Message sent!`)
			} else {
				const [majorVer, minorVer, patchVer] = (liff.getLineVersion() || "").split('.');

				if (minorVer === undefined) {
					alert('ShareTargetPicker was canceled in external browser')
					return
				}

				if (parseInt(majorVer) >= 10 && parseInt(minorVer) >= 10 && parseInt(patchVer) > 0) {
					alert('ShareTargetPicker was canceled in LINE app')
				}
			}
		}
		
		function logOut() {
			liff.logout()
			window.location.reload()
		}

		async function main() {
			await liff.init({ liffId: "2007160752-2lG4AlD3" })
			if (liff.isLoggedIn()) {
				document.getElementById("btnShare").style.display = "block"
				document.getElementById("btnShare2").style.display = "block"
				document.getElementById("btnShare3").style.display = "block"
				if (!liff.isInClient()) {
					document.getElementById("btnLogOut").style.display = "block"
				}
			} else {
				document.getElementById("btnLogin").style.display = "block"
			}
		}
		main()
	</script>
</body>

</html>
